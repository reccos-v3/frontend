<!-- Main Container -->
<div class="w-full min-h-screen flex flex-col lg:flex-row relative">
  <!-- Left Panel: Sporty Visual -->
  <div class="hero-panel">
    <!-- Background Overlay -->
    <div class="hero-background">
      <img
        alt="Estádio de futebol iluminado à noite"
        class="hero-background-image"
        src="https://lh3.googleusercontent.com/aida-public/AB6AXuC4i4Wnl5qnXhFjVb6MyGqQRlquHysCBDlTdUumuaJJKllpbBHLeg0I9y4MPGymeVtJyJj73FtAiqdyzGDS2uLWIR0OISCW2MYTLB7D6ayCDEhKEeK6qNux_dp79dks8z7ERJkTfvPD4LC51ZP1JI3RhDYL0Jo5Ym1vGR6CYEOnqxIccVb6NIiE2aRhe27XlBLsBKspDfBRk7AoGSaovMEYTQ2wSUiAylSwVCYKVTKD5cbi03z80CHOeG9STgnnnqmQf77hhgWT_BU"
      />
      <div class="hero-overlay-gradient"></div>
      <div class="hero-overlay-gradient-secondary"></div>
    </div>

    <!-- Content -->
    <div class="hero-content">
      <!-- Logo Section -->
      <div class="flex items-center gap-3 mb-8 lg:mb-12">
        <div
          class="size-10 bg-primary rounded-xl flex items-center justify-center text-white shadow-lg shadow-primary/20"
        >
          <span class="material-symbols-outlined text-2xl">sports_soccer</span>
        </div>
        <h1 class="text-xl font-bold tracking-tight text-white">ArenaManager</h1>
      </div>

      <!-- Hero Message -->
      <div class="hero-message">
        <div
          class="hero-message-content"
          [class.slide-change]="true"
          [attr.data-slide]="currentSlide()"
        >
          <h1 class="hero-title">{{ getCurrentMessage().title }}</h1>
          <p class="hero-description">
            {{ getCurrentMessage().description }}
          </p>
        </div>
      </div>

      <!-- Pagination Dots -->
      <div class="flex gap-2 items-center mt-auto">
        @for (message of heroMessages; track $index) {
          <button
            type="button"
            class="dot h-1.5 rounded-full border-none cursor-pointer p-0 transition-all outline-none"
            [class.dot-active]="currentSlide() === $index"
            (click)="goToSlide($index)"
            [attr.aria-label]="'Ir para slide ' + ($index + 1)"
          ></button>
        }
      </div>

      <!-- Footer Info -->
      <div class="mt-6 pt-6">
        <p class="text-xs text-white/60 text-left">
          © 2025 ArenaManager. Acesso restrito a convidados.
        </p>
      </div>
    </div>
  </div>

  <!-- Right Panel: Form -->
  <div class="form-panel">
    <div class="w-full max-w-[480px] flex flex-col gap-8 md:gap-6">
      <!-- LOADING STATE -->
      @if (tokenStatus() === 'validating') {
        <div class="flex flex-col items-center justify-center gap-4 py-10">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
          <p class="text-secondary font-medium">Validando link de recuperação...</p>
        </div>
      }

      <!-- INVALID TOKEN STATE -->
      @if (tokenStatus() === 'invalid') {
        <div class="flex flex-col gap-6 text-center py-6">
          <div class="w-16 h-16 rounded-full bg-red-50 flex items-center justify-center mx-auto">
            <span class="material-symbols-outlined text-red-500 text-3xl">broken_image</span>
          </div>
          <div class="flex flex-col gap-2">
            <h2 class="text-xl font-bold text-secondary">Link Inválido ou Expirado</h2>
            <p class="text-sm text-neutral-gray">
              O link de recuperação que você acessou não é mais válido. Por favor, solicite uma nova
              redefinição de senha.
            </p>
          </div>
          <a
            routerLink="/forgot-password"
            class="w-full h-12 bg-primary text-white font-bold rounded-full flex items-center justify-center no-underline hover:bg-primary-hover transition-colors"
          >
            Solicitar nova senha
          </a>
        </div>
      }

      <!-- VALID TOKEN STATE (FORM) -->
      @if (tokenStatus() === 'valid') {
        <!-- Header Section -->
        <div class="flex flex-col gap-2">
          <h2 class="form-title">Redefinir Senha</h2>
          <p class="form-subtitle">
            Crie uma nova senha segura para recuperar o acesso à sua conta no sistema.
          </p>
        </div>

        <!-- Form Fields -->
        <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-5 md:gap-4">
          <!-- Password Field -->
          <div class="flex flex-col gap-2">
            <label class="text-base font-medium text-secondary leading-normal" for="password"
              >Nova senha</label
            >
            <div class="relative w-full flex items-center">
              <input
                class="form-input"
                id="password"
                [type]="showPassword() ? 'text' : 'password'"
                formControlName="password"
                placeholder="Insira sua nova senha"
                (input)="onPasswordChange($any($event.target).value)"
              />
              <button
                type="button"
                class="absolute right-4 bg-none border-none text-primary-light hover:text-primary cursor-pointer p-0 flex items-center justify-center transition-colors"
                (click)="togglePasswordVisibility()"
                tabindex="-1"
              >
                <span class="material-symbols-outlined text-2xl">
                  {{ showPassword() ? 'visibility' : 'visibility_off' }}
                </span>
              </button>
            </div>
            <!-- Password Strength Indicator -->
            <div class="flex gap-1 mt-1">
              <div
                class="strength-segment flex-1 h-1 rounded-full transition-colors"
                [class.active]="passwordStrength().level >= 1"
              ></div>
              <div
                class="strength-segment flex-1 h-1 rounded-full transition-colors"
                [class.active]="passwordStrength().level >= 2"
              ></div>
              <div
                class="strength-segment flex-1 h-1 rounded-full transition-colors"
                [class.active]="passwordStrength().level >= 3"
              ></div>
              <div
                class="strength-segment flex-1 h-1 rounded-full transition-colors"
                [class.active]="passwordStrength().level >= 4"
              ></div>
            </div>
            <p class="text-xs font-medium text-primary mt-1">
              Força da senha: {{ getPasswordStrengthText() }}
            </p>
          </div>

          <!-- Confirm Password Field -->
          <div class="flex flex-col gap-2">
            <label class="text-base font-medium text-secondary leading-normal" for="confirmPassword"
              >Confirmar nova senha</label
            >
            <div class="relative w-full flex items-center">
              <input
                class="form-input"
                id="confirmPassword"
                [type]="showConfirmPassword() ? 'text' : 'password'"
                formControlName="confirmPassword"
                placeholder="Repita a nova senha"
                (input)="onConfirmPasswordChange($any($event.target).value)"
              />
              <button
                type="button"
                class="absolute right-4 bg-none border-none text-primary-light hover:text-primary cursor-pointer p-0 flex items-center justify-center transition-colors"
                (click)="toggleConfirmPasswordVisibility()"
                tabindex="-1"
              >
                <span class="material-symbols-outlined text-2xl">
                  {{ showConfirmPassword() ? 'visibility' : 'visibility_off' }}
                </span>
              </button>
            </div>
          </div>

          <!-- Validation Checklist -->
          <div
            class="validation-checklist bg-[rgba(30,128,79,0.03)] border border-[rgba(30,128,79,0.08)] rounded-lg p-3 -mt-2"
          >
            <p class="checklist-title text-xs font-medium text-neutral-gray mb-1.5">
              Sua senha deve conter:
            </p>
            <ul class="flex flex-col gap-1.5 list-none p-0 m-0">
              <li
                class="checklist-item flex items-center gap-1.5 text-xs text-gray-400"
                [class.valid]="hasMinLength()"
              >
                <span class="material-symbols-outlined checklist-icon text-sm">
                  {{ hasMinLength() ? 'check_circle' : 'radio_button_unchecked' }}
                </span>
                Mínimo de 8 caracteres
              </li>
              <li
                class="checklist-item flex items-center gap-1.5 text-xs text-gray-400"
                [class.valid]="hasUppercase()"
              >
                <span class="material-symbols-outlined checklist-icon text-sm">
                  {{ hasUppercase() ? 'check_circle' : 'radio_button_unchecked' }}
                </span>
                Uma letra maiúscula
              </li>
              <li
                class="checklist-item flex items-center gap-1.5 text-xs text-gray-400"
                [class.valid]="hasNumberOrSymbol()"
              >
                <span class="material-symbols-outlined checklist-icon text-sm">
                  {{ hasNumberOrSymbol() ? 'check_circle' : 'radio_button_unchecked' }}
                </span>
                Um número ou símbolo especial
              </li>
            </ul>
          </div>

          <!-- Action Button -->
          <button
            class="submit-button w-full h-12 bg-primary text-white text-base font-bold tracking-wide leading-normal border-none rounded-full cursor-pointer transition-all scale-100 shadow-[0_10px_15px_-3px_var(--overlay-primary-medium)] mt-2 flex items-center justify-center hover:bg-primary-hover active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed"
            type="submit"
            [disabled]="!isFormValid() || isSubmitting()"
          >
            @if (isSubmitting()) {
              <span
                class="inline-block w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"
              ></span>
              <span>Redefinindo...</span>
            } @else {
              <span>Redefinir senha</span>
            }
          </button>
        </form>
      }

      <!-- Back Link (Always Visible) -->
      <div class="flex justify-center mt-auto">
        <a
          class="flex items-center gap-2 text-sm font-medium text-primary-light no-underline transition-colors hover:text-primary"
          routerLink="/login"
        >
          <span class="material-symbols-outlined text-lg transition-transform hover:-translate-x-1"
            >arrow_back</span
          >
          Voltar ao login
        </a>
      </div>
    </div>
  </div>
</div>
