<main class="w-full space-y-8">
  <!-- Aguardando Ação (DRAFT/CONFIGURING) -->
  @if (itemsPending().length > 0) {
  <section>
    <h2 class="font-display font-bold text-xl text-dark-blue dark:text-white mb-6">
      Aguardando Ação
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      @for (item of itemsPending(); track item.id) {
      <ng-container *ngTemplateOutlet="cardTemplate; context: { $implicit: item }"></ng-container>
      }
    </div>
  </section>
  }

  <!-- Ativos (ACTIVE) -->
  @if (itemsActive().length > 0) {
  <section>
    <h2 class="font-display font-bold text-2xl text-dark-blue dark:text-white mb-6">Ativos</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      @for (item of itemsActive(); track item.id) {
      <ng-container *ngTemplateOutlet="cardTemplate; context: { $implicit: item }"></ng-container>
      }
    </div>
  </section>
  }

  <!-- Concluídos (FINISHED) -->
  @if (itemsFinished().length > 0) {
  <section>
    <h2 class="font-display font-bold text-2xl text-dark-blue dark:text-white mb-6">Concluídos</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      @for (item of itemsFinished(); track item.id) {
      <ng-container *ngTemplateOutlet="cardTemplate; context: { $implicit: item }"></ng-container>
      }
    </div>
  </section>
  } @if (data().length === 0) {
  <div class="flex flex-col items-center justify-center py-20 text-text-muted">
    <span class="material-symbols-outlined text-6xl mb-4">inventory_2</span>
    <p class="text-lg">Nenhum campeonato encontrado.</p>
  </div>
  }

  <!-- Pagination -->
  @if (pagination() && (pagination()?.totalPages ?? 0) > 1) {
  <div class="flex justify-center pt-8">
    <nav
      class="flex items-center gap-1 bg-surface-light dark:bg-surface-dark rounded-lg p-1 border border-gray-100/50 dark:border-gray-800/40 shadow-sm"
    >
      <button
        (click)="goToPage((pagination()?.currentPage ?? 1) - 1)"
        [disabled]="pagination()?.currentPage === 0"
        class="w-10 h-10 flex items-center justify-center rounded-md hover:bg-neutral-gray/50 dark:hover:bg-gray-700 text-text-muted dark:text-gray-400 disabled:opacity-50 transition-colors"
      >
        <span class="material-symbols-outlined text-lg">chevron_left</span>
      </button>

      @for (page of getPages(); track page) {
      <button
        (click)="goToPage(page)"
        [class]="
          pagination()?.currentPage === page
            ? 'bg-primary text-white shadow-sm'
            : 'hover:bg-neutral-gray/50 dark:hover:bg-gray-700 text-text-muted dark:text-gray-400'
        "
        class="w-10 h-10 flex items-center justify-center rounded-md font-medium text-sm transition-colors"
      >
        {{ page + 1 }}
      </button>
      }

      <button
        (click)="goToPage((pagination()?.currentPage ?? 0) + 1)"
        [disabled]="pagination()?.currentPage === (pagination()?.totalPages ?? 0) - 1"
        class="w-10 h-10 flex items-center justify-center rounded-md hover:bg-neutral-gray/50 dark:hover:bg-gray-700 text-text-muted dark:text-gray-400 disabled:opacity-50 transition-colors"
      >
        <span class="material-symbols-outlined text-lg">chevron_right</span>
      </button>
    </nav>
  </div>
  }
</main>

<!-- Reusable Card Template -->
<ng-template #cardTemplate let-item>
  @let config = getStatusConfig(item.status);
  <article
    class="group relative bg-white dark:bg-surface-dark rounded-xl border border-gray-100/50 dark:border-gray-800/40 overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1"
  >
    <div class="absolute top-0 left-0 w-1 h-full" [class]="'bg-' + config.color"></div>
    <div class="p-6">
      <div class="flex justify-between items-start mb-4">
        <div
          class="w-14 h-14 rounded-lg p-2 border flex items-center justify-center"
          [class]="'bg-' + config.color + '/10 border-gray-300 dark:border-gray-800'"
        >
          <span class="material-symbols-outlined text-3xl" [class]="'text-' + config.color">
            sports_soccer
          </span>
        </div>
        <div class="flex items-center gap-1">
          <button
            (click)="handleEdit(item)"
            class="p-2 text-text-muted hover:text-primary hover:bg-primary/5 rounded-lg transition-colors"
            title="Editar"
          >
            <span class="material-symbols-outlined text-[20px]">edit</span>
          </button>
          <button
            (click)="handleDelete(item)"
            class="p-2 text-text-muted hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors"
            title="Excluir"
          >
            <span class="material-symbols-outlined text-[20px]">delete</span>
          </button>
          <span
            class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium border"
            [class]="
              'bg-' + config.color + '/10 text-' + config.color + ' border-' + config.color + '/10'
            "
          >
            @if (config.pulse) {
            <span
              class="w-1.5 h-1.5 rounded-full animate-pulse"
              [class]="'bg-' + config.color"
            ></span>
            } @else {
            <span class="material-symbols-outlined text-[14px]">{{ config.icon }}</span>
            }
            {{ config.label }}
          </span>
        </div>
      </div>

      <h3
        class="font-display font-bold text-lg text-dark-blue dark:text-white mb-2 line-clamp-1 group-hover:text-primary transition-colors"
      >
        {{ item.name }}
      </h3>

      <div class="space-y-3 mb-6">
        <div class="flex items-center gap-2 text-xs text-text-muted dark:text-gray-400">
          <span class="material-symbols-outlined text-[18px] text-info-medium-blue">
            sports_soccer
          </span>
          <span class="font-medium">{{ item.modality.name }}</span>
          <span class="w-1 h-1 rounded-full bg-neutral-gray dark:bg-gray-600"></span>
          <span>{{ item.season.name ?? 'Sem Temporada' }}</span>
        </div>
        <div class="flex items-center gap-2 text-xs text-text-muted dark:text-gray-400">
          <span class="material-symbols-outlined text-[18px] text-info-medium-blue">groups</span>
          <span>{{ item.teamsCount }} Equipes</span>
          <span class="w-1 h-1 rounded-full bg-neutral-gray dark:bg-gray-600"></span>
          <span>{{
            item.gender.charAt(0).toUpperCase() + item.gender.slice(1).toLocaleLowerCase()
          }}</span>
        </div>

        @if (item.status === 'CONFIGURING' || item.status === 'DRAFT') {
        <div class="w-full bg-neutral-gray dark:bg-gray-700 rounded-full h-1.5 mt-2">
          <!-- Mock progress for now or use actual progress if available -->
          <div class="bg-alert-yellow h-1.5 rounded-full" [style.width.%]="40"></div>
        </div>
        }
      </div>

      <div
        class="flex items-center justify-between pt-4 border-t border-gray-50 dark:border-gray-800/20"
      >
        <div class="text-[11px] font-medium text-text-muted">
          ID: #{{ item.id.substring(0, 13) }}
        </div>
        <button
          (click)="handleManage(item)"
          class="text-primary hover:text-primary-dark font-medium text-xs flex items-center gap-1 transition-colors group/btn"
        >
          {{ item.status === 'ACTIVE' ? 'Gerenciar' : 'Ver Detalhes' }}
          <span
            class="material-symbols-outlined text-xs group-hover/btn:translate-x-0.5 transition-transform"
            >arrow_forward</span
          >
        </button>
      </div>
    </div>
  </article>
</ng-template>
