<div class="max-w-[1000px] mx-auto">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-main dark:text-white tracking-tight mb-2">
      Estrutura da Disputa
    </h1>
    <p class="text-secondary text-base">
      Defina como os jogos serão organizados, fases de grupos e critérios de classificação.
    </p>

    <app-alert
      class="block mb-8"
      type="info"
      message="A estrutura selecionada impactará diretamente na geração automática da tabela de jogos. Certifique-se de que o número de times é compatível."
    />
  </div>
  <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
    <!-- Left Column: Form Configuration -->
    <div class="xl:col-span-2 space-y-8">
      <section
        class="bg-white dark:bg-surface-dark rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-800"
      >
        @switch (internalStep()) {
          @case ('selection') {
            <app-setup-knockout
              [selectedFormat]="selectedFormat()"
              [groupsCount]="groupsCount()"
              [qualifiedPerGroup]="qualifiedPerGroup()"
              [totalTeams]="totalTeams()"
              (updateFormat)="selectedFormat.set($event)"
              (updateGroupsCount)="updateGroupsCount($event)"
              (updateQualified)="updateQualified($event)"
              (updateTotalTeams)="updateTotalTeams($event)"
              (updateSchedulePreferences)="updateSchedulePreferences($event)"
            />
          }
          @case ('configuration') {
            <app-setup-format-knockout
              [totalTeams]="totalTeams()"
              [externalPhases]="storedPhases()"
            />
          }
        }
      </section>
    </div>
    <!-- Right Column: Visualization Preview -->
    <div class="xl:col-span-1">
      <app-setup-sidebar-format
        [selectedFormat]="debouncedFormat()!"
        [totalTeams]="debouncedTotalTeams()!"
        [groupsCount]="debouncedGroupsCount()!"
        [qualifiedPerGroup]="debouncedQualified()!"
        (phasesChange)="handlePhasesChange($event)"
      />
    </div>
  </div>
</div>
<!-- Fixed Bottom Action Bar -->
<!-- <div
  class="fixed bottom-0 left-0 right-0 lg:left-[280px] bg-white dark:bg-surface-dark border-t border-gray-100 dark:border-gray-800 p-4 z-30"
> -->
<div class="mt-8 max-w-[1000px] mx-auto flex justify-end items-center relative z-50">
  <button
    type="button"
    (click)="returnToPrevious()"
    class="flex items-center gap-2 px-6 py-3 rounded-full text-secondary hover:text-primary hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors font-medium text-sm"
  >
    <span class="material-symbols-outlined text-lg">arrow_back</span>
    Voltar
  </button>
  <button
    type="button"
    (click)="saveAndContinue()"
    class="flex items-center gap-2 px-8 py-3 rounded-full bg-primary hover:bg-primary-dark text-white shadow-lg shadow-primary/20 transition-all transform hover:-translate-y-0.5 font-bold text-sm"
  >
    Próximo
    <span class="material-symbols-outlined text-lg">arrow_forward</span>
  </button>
  <!-- </div> -->
</div>
